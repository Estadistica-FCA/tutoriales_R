<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Tutoriales R: ¿Cómo manipular datos con `dplyr`?</title>




  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Tutoriales R: ¿Cómo manipular datos con `dplyr`?"/>
  <meta property="og:type" content="article"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Tutoriales R"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Tutoriales R: ¿Cómo manipular datos con `dplyr`?"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title"]}},"value":[{"type":"character","attributes":{},"value":["¿Cómo manipular datos con `dplyr`?"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"¿Cómo manipular datos con `dplyr`?","authors":[]}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo">
<img src="assets/logo_webFCA.svg" alt="Logo"/>
</a>
<a href="index.html" class="title">Tutoriales R</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Contenidos
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="como_instalar_R_Rstudio.html">¿Cómo instalar R y RStudio?</a>
<a href="primera_sesion.html">¿Cómo se usa RStudio?</a>
<a href="R_basico.html">¿Cómo es el lenguaje R?</a>
<a href="como_crear_proyecto_rstudio.html">¿Cómo crear un proyecto en Rstudio?</a>
<a href="como_instalar_y_cargar_paquetes.html">¿Cómo instalar y cargar paquetes?</a>
<a href="como_importar_datos_en_R.html">¿Cómo importar datos en R?</a>
<a href="introduccion_a_dplyr.html">¿Cómo manipular datos con `dplyr`?</a>
<a href="introduccion_a_ggplot2.html">¿Cómo visualizar datos con `ggplot2`?</a>
</div>
</div>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="index.html" aria-label="Home">
<i class="fa fa-home" aria-hidden="true"></i>
</a>
<a href="about.html">About</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>¿Cómo manipular datos con dplyr?</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->

</div>


<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#qué-es-dplyr">¿Qué es <code>dplyr</code>?</a></li>
<li><a href="#cómo-conseguir-dplyr">¿Cómo conseguir <code>dplyr</code>?</a></li>
<li><a href="#verbos-importantes-de-dplyr-para-recordar">Verbos importantes de <code>dplyr</code> para recordar</a></li>
<li><a href="#dplyr-en-acción"><code>dplyr</code> en acción</a></li>
</ul>
</nav>
</div>
<h2 id="qué-es-dplyr">¿Qué es <code>dplyr</code>?</h2>
<p><code>dplyr</code> es un paquete de <strong>R</strong> muy potente para la exploración, transformación y resumen de datos en formato de tabla con filas (observaciones) y columnas (variables). Es un componente de un conjunto de packages llamado <code>tidyverse</code> desarrollados por <a href="http://hadley.nz/">Hadley Wickham</a></p>
<p>El paquete contiene un conjunto de funciones (o <em>verbos</em>) que realizan operaciones comunes para el manejo de datos tales como: filtrar filas, seleccionar columnas, re-ordenar filas, agregar o transformar columnas, resumir datos. También permite agrupar los datos facilitando la estrategia <em>split-apply-combine</em>, es decir, dividir (<em>split</em>) los datos según una variable de grupo, aplicar (<em>apply</em>) alguna transformación o resumen y combinar (<em>combine</em>) las partes para presentar los resultados.</p>
<p>Si bien <strong>R</strong> base tiene funciones que realizan las mismas tareas (<code>split()</code>, <code>subset()</code>, <code>apply()</code>, <code>sapply()</code>, <code>lapply()</code>, <code>tapply()</code> and <code>aggregate()</code>), el paquete <code>dplyr</code> brinda una interface más consistente que permite trabajar de manera más facil con <code>data.frame</code> (tabla de datos) más que con vectores.</p>
<h2 id="cómo-conseguir-dplyr">¿Cómo conseguir <code>dplyr</code>?</h2>
<p>Para instalar por primera vez en la computadora:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Solo</span>
<span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='st'>"dplyr"</span><span class='op'>)</span>

<span class='co'># O junto con la familia tidyverse</span>
<span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='st'>"tidyverse"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Lo anterior se debe realizar por única vez si el paquete no está previamente instalado en la máquina. Para usar las funciones en una sesion de trabajo hay que cargarlo con <code>library()</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Solo</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://dplyr.tidyverse.org'>"dplyr"</a></span><span class='op'>)</span>

<span class='co'># O junto con la familia tidyverse</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://tidyverse.tidyverse.org'>"tidyverse"</a></span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p><strong>R</strong> va a avisarnos en la consola que esta enmascarando (reemplazando) algunas funciones que ya estaban en el entorno, o bien el paquete nos devuelve algun mensaje. A menos que diga <code>Error ...</code>, eso está bien.</p>
<h2 id="verbos-importantes-de-dplyr-para-recordar">Verbos importantes de <code>dplyr</code> para recordar</h2>
<p>Toda la estrategia de trabajo con datos de <code>dplyr</code> se basa en 6 verbos:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">verbo</th>
<th style="text-align: left;">descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>select()</code></td>
<td style="text-align: left;">selecciona columnas (variables)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>filter()</code></td>
<td style="text-align: left;">filtra o selecciona las filas (observaciones)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>arrange()</code></td>
<td style="text-align: left;">re-ordena las filas</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>mutate()</code></td>
<td style="text-align: left;">crea nuevas columnas o modifica las preexistentes</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>summarise()</code></td>
<td style="text-align: left;">resumen los valores de una variable</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>group_by()</code></td>
<td style="text-align: left;">permite aplicar los verbos anteriores en subgrupos (<em>split-apply-combine</em>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>sample_n()</code></td>
<td style="text-align: left;">para tomar muestras aleatorias con o sin reposición</td>
</tr>
</tbody>
</table>
<p>En la mayoría de los casos la sintaxis es:</p>
<p><code>function(que_datos, que_hacer_con_los_datos)</code></p>
<p>En <code>que_datos</code> hay que poner el nombre del set de datos o <code>data.frame</code> (a menos que se use el operador <code>%&gt;%</code> para encadenar, mas adelante) y en <code>que_hacer_con_los_datos</code> indicar que operación, condicion, transformacion, etc aplicar a las filas y columnas.</p>
<h2 id="dplyr-en-acción"><code>dplyr</code> en acción</h2>
<p>Para ilustrar el uso del paquete vamos a usar los datos contenidos en el archivo <a href="https://github.com/Estadistica-FCA/tutoriales_R/raw/master/data/pesada_terneros.xlsx"><code>pesada_terneros.xlsx</code></a>. Para más detalles ir a la hoja de descripción de datos.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Cargar los datos con readxl</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://readxl.tidyverse.org'>readxl</a></span><span class='op'>)</span>
<span class='va'>terneros</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span><span class='st'>"./data/pesada_terneros.xlsx"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="seleccionando-variables">Seleccionando variables</h3>
<p>Una tareas básicas cuando se exploran datos es la selección de columnas de interés (variables). Esto se lleva a cabo con <code>select()</code>.</p>
<p>Para seleccionar las columnas <code>Procedencia</code>, <code>IDV</code> y <code>Peso</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Sin asignar</span>
<span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>terneros</span>, <span class='va'>Procedencia</span>, <span class='va'>IDV</span>, <span class='va'>Peso</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 1,598 × 3
   Procedencia IDV        Peso
   &lt;chr&gt;       &lt;chr&gt;     &lt;dbl&gt;
 1 La Rosita   NR047A202   204
 2 La Rosita   GN685B267   186
 3 La Rosita   AI101A751   182
 4 La Rosita   TM603C877   186
 5 La Rosita   TM420B797   186
 6 La Rosita   LH837F500   208
 7 La Rosita   NR047A217   170
 8 La Rosita   LH837F508   188
 9 La Rosita   GN685B256   172
10 La Rosita   QW110A058   172
# … with 1,588 more rows</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Creando un nuevo set de datos</span>
<span class='va'>mis_columnas</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>terneros</span>, <span class='va'>Procedencia</span>, <span class='va'>IDV</span>, <span class='va'>Peso</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Por defecto, si no se asigna a un nuevo objeto, el resultado de la operación se imprime en la consola con la función <code>print()</code> la cual por defecto muestra las 10 primeras observaciones y la cantidad de columnas que entran en la pantalla. Aquellas columnas que no entran son indicadas al pie.</p>
<p>Si quiero ver más registros se puede usar el argumento <code>n =</code> de <code>print()</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>mis_columnas</span>, n <span class='op'>=</span> <span class='fl'>15</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 1,598 × 3
   Procedencia IDV        Peso
   &lt;chr&gt;       &lt;chr&gt;     &lt;dbl&gt;
 1 La Rosita   NR047A202   204
 2 La Rosita   GN685B267   186
 3 La Rosita   AI101A751   182
 4 La Rosita   TM603C877   186
 5 La Rosita   TM420B797   186
 6 La Rosita   LH837F500   208
 7 La Rosita   NR047A217   170
 8 La Rosita   LH837F508   188
 9 La Rosita   GN685B256   172
10 La Rosita   QW110A058   172
11 La Rosita   LH837F497   188
12 La Rosita   TM420B803   180
13 La Rosita   LH837F514   198
14 La Rosita   II641B940   200
15 La Rosita   IY735C      242
# … with 1,583 more rows</code></pre>
</div>
<p>Con <code>n = "all"</code> se imprimen todas (no se muestra por razones obvias)</p>
<p>El orden en que aparecen las variables en el resultado es el orden que se utilizó al seleccionarlas.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># El orden altera el producto</span>
<span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>terneros</span>, <span class='va'>Procedencia</span>, <span class='va'>IDV</span>, <span class='va'>Peso</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 1,598 × 3
   Procedencia IDV        Peso
   &lt;chr&gt;       &lt;chr&gt;     &lt;dbl&gt;
 1 La Rosita   NR047A202   204
 2 La Rosita   GN685B267   186
 3 La Rosita   AI101A751   182
 4 La Rosita   TM603C877   186
 5 La Rosita   TM420B797   186
 6 La Rosita   LH837F500   208
 7 La Rosita   NR047A217   170
 8 La Rosita   LH837F508   188
 9 La Rosita   GN685B256   172
10 La Rosita   QW110A058   172
# … with 1,588 more rows</code></pre>
</div>
<p>También se puede usar los comnados <code>starts_with()</code>, <code>ends_with()</code>, <code>contains()</code>, etc (ver <code>?select_helpers)</code> para más opciones). Para elegir varias columnas que tienen un patron sin tener que tipear todos los nombres.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Selecciona columnas que empiezan con P</span>
<span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>terneros</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>starts_with</a></span><span class='op'>(</span><span class='st'>"P"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 1,598 × 2
   Procedencia  Peso
   &lt;chr&gt;       &lt;dbl&gt;
 1 La Rosita     204
 2 La Rosita     186
 3 La Rosita     182
 4 La Rosita     186
 5 La Rosita     186
 6 La Rosita     208
 7 La Rosita     170
 8 La Rosita     188
 9 La Rosita     172
10 La Rosita     172
# … with 1,588 more rows</code></pre>
</div>
<p>Para omitir algunas columnas en la seleccion se puede usar el <code>-</code> antes del nombre.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Selecciona columnas que empiezan con P</span>
<span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>terneros</span>, <span class='op'>-</span><span class='va'>IDV</span>, <span class='op'>-</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>starts_with</a></span><span class='op'>(</span><span class='st'>"P"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 1,598 × 5
   Sexo  `Fecha Ingreso`     Categoria Fecha              
   &lt;chr&gt; &lt;dttm&gt;              &lt;chr&gt;     &lt;dttm&gt;             
 1 Macho 2017-07-20 00:00:00 Ternero   2017-04-06 00:00:00
 2 Macho 2017-07-20 00:00:00 Ternero   2017-04-06 00:00:00
 3 Macho 2017-07-21 00:00:00 Ternero   2017-04-06 00:00:00
 4 Macho 2017-07-20 00:00:00 Ternero   2017-04-06 00:00:00
 5 Macho 2017-07-24 00:00:00 Ternero   2017-04-06 00:00:00
 6 Macho 2017-07-24 00:00:00 Ternero   2017-04-06 00:00:00
 7 Macho 2017-07-21 00:00:00 Ternero   2017-04-06 00:00:00
 8 Macho 2017-07-24 00:00:00 Ternero   2017-04-06 00:00:00
 9 Macho 2017-07-21 00:00:00 Ternero   2017-04-06 00:00:00
10 Macho 2017-07-24 00:00:00 Ternero   2017-04-06 00:00:00
# … with 1,588 more rows, and 1 more variable: Hora &lt;dttm&gt;</code></pre>
</div>
<h3 id="seleccionando-observaciones">Seleccionando observaciones</h3>
<p>Otra tarea muy frecuente es seleccionar casos o observaciones que cumplan con alguna condición. Esto se lleva a cabo con <code>filter()</code>. Se pueden usar los operadores <em>booleanos</em> <code>==</code>, <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>!=</code>, <code>%in%</code>) para crear pruebas o condiciones lógicas.</p>
<p>Para seleccionar los terneros de <code>Los Corralitos</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Sin asignar</span>
<span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>terneros</span>, <span class='va'>Procedencia</span> <span class='op'>==</span> <span class='st'>'Los Corralitos'</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 575 × 8
   IDV       Procedencia    Sexo  `Fecha Ingreso`     Categoria
   &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt; &lt;dttm&gt;              &lt;chr&gt;    
 1 PO150A167 Los Corralitos Macho 2017-07-23 00:00:00 Ternero  
 2 PO150A168 Los Corralitos Macho 2017-07-22 00:00:00 Ternero  
 3 PO150A169 Los Corralitos Macho 2017-07-22 00:00:00 Ternero  
 4 PO150A460 Los Corralitos Macho 2017-07-23 00:00:00 Ternero  
 5 PO150A673 Los Corralitos Macho 2017-07-22 00:00:00 Ternero  
 6 PO150A461 Los Corralitos Macho 2017-07-22 00:00:00 Ternero  
 7 PO150A462 Los Corralitos Macho 2017-07-22 00:00:00 Ternero  
 8 PO150A463 Los Corralitos Macho 2017-07-22 00:00:00 Ternero  
 9 PO150A433 Los Corralitos Macho 2017-06-06 00:00:00 Ternero  
10 PO150A434 Los Corralitos Macho 2017-07-22 00:00:00 Ternero  
# … with 565 more rows, and 3 more variables: Fecha &lt;dttm&gt;,
#   Hora &lt;dttm&gt;, Peso &lt;dbl&gt;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Creando un nuevo set de datos</span>
<span class='va'>corralitos</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>terneros</span>, <span class='va'>Procedencia</span> <span class='op'>==</span> <span class='st'>'Los Corralitos'</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>La seleccion se puede hacer por más de una condicion. Por ejemplo, seleccionar los de <code>Los Corralitos</code> que pesen más de 200 kg:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>terneros</span>, <span class='va'>Procedencia</span> <span class='op'>==</span> <span class='st'>'Los Corralitos'</span>, <span class='va'>Peso</span> <span class='op'>&gt;</span> <span class='fl'>200</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 260 × 8
   IDV       Procedencia    Sexo  `Fecha Ingreso`     Categoria
   &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt; &lt;dttm&gt;              &lt;chr&gt;    
 1 PO150A167 Los Corralitos Macho 2017-07-23 00:00:00 Ternero  
 2 PO150A168 Los Corralitos Macho 2017-07-22 00:00:00 Ternero  
 3 PO150A169 Los Corralitos Macho 2017-07-22 00:00:00 Ternero  
 4 PO150A673 Los Corralitos Macho 2017-07-22 00:00:00 Ternero  
 5 PO150A462 Los Corralitos Macho 2017-07-22 00:00:00 Ternero  
 6 PO150A463 Los Corralitos Macho 2017-07-22 00:00:00 Ternero  
 7 PO150A434 Los Corralitos Macho 2017-07-22 00:00:00 Ternero  
 8 PO150A435 Los Corralitos Macho 2017-07-23 00:00:00 Ternero  
 9 PO150A675 Los Corralitos Macho 2017-07-22 00:00:00 Ternero  
10 PO150A681 Los Corralitos Macho 2017-07-22 00:00:00 Ternero  
# … with 250 more rows, and 3 more variables: Fecha &lt;dttm&gt;,
#   Hora &lt;dttm&gt;, Peso &lt;dbl&gt;</code></pre>
</div>
<p><code>filter()</code> asume que cada condicion se debe cumplir en simultaneo para que la observación sea seleccionada. Esto equivale a utilizar el operador <code>&amp;</code> (<em>Y</em>). En caso de querer seleccionar aquellos registros que cumple una u otra condicion se usa el operador <code>|</code> (<em>O</em>). Poniendo <code>!</code> delante de la condicion se invierte la selección.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Operador &amp;</span>
<span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>terneros</span>, <span class='va'>Procedencia</span> <span class='op'>==</span> <span class='st'>'Los Corralitos'</span> <span class='op'>&amp;</span> <span class='va'>Peso</span> <span class='op'>&gt;</span> <span class='fl'>200</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 260 × 8
   IDV       Procedencia    Sexo  `Fecha Ingreso`     Categoria
   &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt; &lt;dttm&gt;              &lt;chr&gt;    
 1 PO150A167 Los Corralitos Macho 2017-07-23 00:00:00 Ternero  
 2 PO150A168 Los Corralitos Macho 2017-07-22 00:00:00 Ternero  
 3 PO150A169 Los Corralitos Macho 2017-07-22 00:00:00 Ternero  
 4 PO150A673 Los Corralitos Macho 2017-07-22 00:00:00 Ternero  
 5 PO150A462 Los Corralitos Macho 2017-07-22 00:00:00 Ternero  
 6 PO150A463 Los Corralitos Macho 2017-07-22 00:00:00 Ternero  
 7 PO150A434 Los Corralitos Macho 2017-07-22 00:00:00 Ternero  
 8 PO150A435 Los Corralitos Macho 2017-07-23 00:00:00 Ternero  
 9 PO150A675 Los Corralitos Macho 2017-07-22 00:00:00 Ternero  
10 PO150A681 Los Corralitos Macho 2017-07-22 00:00:00 Ternero  
# … with 250 more rows, and 3 more variables: Fecha &lt;dttm&gt;,
#   Hora &lt;dttm&gt;, Peso &lt;dbl&gt;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Operador |</span>
<span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>terneros</span>, <span class='va'>Procedencia</span> <span class='op'>==</span> <span class='st'>'Los Corralitos'</span> <span class='op'>|</span> <span class='va'>Peso</span> <span class='op'>&gt;</span> <span class='fl'>200</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 779 × 8
   IDV       Procedencia  Sexo  `Fecha Ingreso`     Categoria
   &lt;chr&gt;     &lt;chr&gt;        &lt;chr&gt; &lt;dttm&gt;              &lt;chr&gt;    
 1 NR047A202 La Rosita    Macho 2017-07-20 00:00:00 Ternero  
 2 LH837F500 La Rosita    Macho 2017-07-24 00:00:00 Ternero  
 3 IY735C    La Rosita    Macho 2017-07-22 00:00:00 Ternero  
 4 QW110A072 La Rosita    Macho 2017-07-24 00:00:00 Ternero  
 5 LH837F526 La Rosita    Macho 2017-07-20 00:00:00 Ternero  
 6 DS289A491 La Rosita    Macho 2017-07-24 00:00:00 Ternero  
 7 TL698HK39 La Rosita    Macho 2017-07-20 00:00:00 Ternero  
 8 LH837F538 La Rosita    Macho 2017-07-21 00:00:00 Ternero  
 9 IW751A017 La Rosita    Macho 2017-07-24 00:00:00 Ternero  
10 NO133A004 Las Glicinas Macho 2017-07-23 00:00:00 Ternero  
# … with 769 more rows, and 3 more variables: Fecha &lt;dttm&gt;,
#   Hora &lt;dttm&gt;, Peso &lt;dbl&gt;</code></pre>
</div>
<p>Con el operador <code>%in%</code> se puede especificar un rango de valores que deben cumplir. Por ejemplo terneros de <code>Los Corralitos</code>, <code>Las Glicinas</code> y <code>Don Alberto</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Indicando cada nombre</span>
<span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>terneros</span>, <span class='va'>Procedencia</span> <span class='op'>==</span> <span class='st'>'Los Corralitos'</span>, <span class='va'>Procedencia</span> <span class='op'>==</span> <span class='st'>'Las Glicinas'</span>, <span class='va'>Procedencia</span> <span class='op'>==</span> <span class='st'>'Don Alberto'</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 0 × 8
# … with 8 variables: IDV &lt;chr&gt;, Procedencia &lt;chr&gt;, Sexo &lt;chr&gt;,
#   Fecha Ingreso &lt;dttm&gt;, Categoria &lt;chr&gt;, Fecha &lt;dttm&gt;, Hora &lt;dttm&gt;,
#   Peso &lt;dbl&gt;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Más resumido con %in%</span>
<span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>terneros</span>, <span class='va'>Procedencia</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'Los Corralitos'</span>, <span class='st'>'Las Glicinas'</span>, <span class='st'>'Don Alberto'</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 1,138 × 8
   IDV       Procedencia  Sexo  `Fecha Ingreso`     Categoria
   &lt;chr&gt;     &lt;chr&gt;        &lt;chr&gt; &lt;dttm&gt;              &lt;chr&gt;    
 1 SZ208I507 Las Glicinas Macho 2017-07-20 00:00:00 Ternero  
 2 SZ208H993 Las Glicinas Macho 2017-06-05 00:00:00 Ternero  
 3 SZ208H849 Las Glicinas Macho 2017-06-05 00:00:00 Ternero  
 4 SZ208H777 Las Glicinas Macho 2017-06-05 00:00:00 Ternero  
 5 GT542A562 Las Glicinas Macho 2017-07-21 00:00:00 Ternero  
 6 OQ152A550 Las Glicinas Macho 2017-07-21 00:00:00 Ternero  
 7 NO133A057 Las Glicinas Macho 2017-07-24 00:00:00 Ternero  
 8 SZ208H888 Las Glicinas Macho 2017-07-22 00:00:00 Ternero  
 9 OQ152A566 Las Glicinas Macho 2017-07-20 00:00:00 Ternero  
10 NO133A047 Las Glicinas Macho 2017-07-20 00:00:00 Ternero  
# … with 1,128 more rows, and 3 more variables: Fecha &lt;dttm&gt;,
#   Hora &lt;dttm&gt;, Peso &lt;dbl&gt;</code></pre>
</div>
<h3 id="encadenando-operaciones-operador">Encadenando operaciones (operador <code>%&gt;%</code>)</h3>
<p><code>dplyr</code> importa el operador <code>%&gt;%</code> de otro paquete llamado <code>magrittr</code>. Este operador permite encadenar operaciones realizadas con los verbos. De este modo no hay que ir creando tablas intermedias o anidar funciones. El operador traduce como <code>luego</code> y se le de izquierda a derecha y se puede.</p>
<p>Ejemplo: Reportar los IDV y peso de los terneros con más de 250 kg. Esto implicaría seleccionar las columnas de interés y luego filtrar la tabla o vice versa.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Creando tablas intermedias</span>
<span class='va'>terneros2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>terneros</span>, <span class='va'>IDV</span>, <span class='va'>Peso</span><span class='op'>)</span>
<span class='va'>terneros2</span>
</code></pre>
</div>
<pre><code># A tibble: 1,598 × 2
   IDV        Peso
   &lt;chr&gt;     &lt;dbl&gt;
 1 NR047A202   204
 2 GN685B267   186
 3 AI101A751   182
 4 TM603C877   186
 5 TM420B797   186
 6 LH837F500   208
 7 NR047A217   170
 8 LH837F508   188
 9 GN685B256   172
10 QW110A058   172
# … with 1,588 more rows</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>terneros2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>terneros2</span>, <span class='va'>Peso</span> <span class='op'>&gt;</span> <span class='fl'>250</span><span class='op'>)</span>
<span class='va'>terneros2</span>
</code></pre>
</div>
<pre><code># A tibble: 75 × 2
   IDV        Peso
   &lt;chr&gt;     &lt;dbl&gt;
 1 NO133A004   258
 2 OQ152A456   258
 3 NO133A006   256
 4 OQ152A553   256
 5 PO150A166   290
 6 PO150A674   256
 7 PO150A656   272
 8 NO133A045   264
 9 PO150A571   264
10 PO150A686   262
# … with 65 more rows</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Anidando</span>
<span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>terneros</span>, <span class='va'>IDV</span>, <span class='va'>Peso</span><span class='op'>)</span>, <span class='va'>Peso</span> <span class='op'>&gt;</span> <span class='fl'>250</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 75 × 2
   IDV        Peso
   &lt;chr&gt;     &lt;dbl&gt;
 1 NO133A004   258
 2 OQ152A456   258
 3 NO133A006   256
 4 OQ152A553   256
 5 PO150A166   290
 6 PO150A674   256
 7 PO150A656   272
 8 NO133A045   264
 9 PO150A571   264
10 PO150A686   262
# … with 65 more rows</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Usando %&gt;%</span>
<span class='va'>terneros</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>IDV</span>, <span class='va'>Peso</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Peso</span> <span class='op'>&gt;</span>  <span class='fl'>250</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 75 × 2
   IDV        Peso
   &lt;chr&gt;     &lt;dbl&gt;
 1 NO133A004   258
 2 OQ152A456   258
 3 NO133A006   256
 4 OQ152A553   256
 5 PO150A166   290
 6 PO150A674   256
 7 PO150A656   272
 8 NO133A045   264
 9 PO150A571   264
10 PO150A686   262
# … with 65 more rows</code></pre>
</div>
<p>Con <code>%&gt;%</code> se puede omitir el nombre de la tabla sobre la que se está trabajando (bonus: menos tipeo).</p>
<p>La última opción se lee: _tomar la tabla <code>terneros</code>, <strong>luego</strong> seleccionar las columnas <code>IDV</code> y <code>Peso</code>, <strong>luego</strong> filtrar los terneros con pesos mayores a 250 kg.</p>
<p>El operador de encadenamiento es muy útil cuando se encadenan muchas operaciones.</p>
<h3 id="ordenar-las-filas">Ordenar las filas</h3>
<p>Para ordenar según algun criterio aplicado a las columnas se usa <code>arrange()</code>. Por ejemplo, continuar con lo anterior pero mostrar ordenadospor peso.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Ordenar de menor a mayor</span>
<span class='va'>terneros</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>IDV</span>, <span class='va'>Peso</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Peso</span> <span class='op'>&gt;</span>  <span class='fl'>250</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>Peso</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 75 × 2
   IDV        Peso
   &lt;chr&gt;     &lt;dbl&gt;
 1 PO150A546   252
 2 NS509H081   252
 3 PO15A710    252
 4 NO133A019   254
 5 PO150A784   254
 6 IA671B182   254
 7 IA671B176   254
 8 PO150A716   254
 9 NO133A006   256
10 OQ152A553   256
# … with 65 more rows</code></pre>
</div>
<p>Con <code>decs(variable)</code> se ordena de mayor a menor</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Ordenar de mayor a menor</span>
<span class='va'>terneros</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>IDV</span>, <span class='va'>Peso</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Peso</span> <span class='op'>&gt;</span>  <span class='fl'>250</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>Peso</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 75 × 2
   IDV        Peso
   &lt;chr&gt;     &lt;dbl&gt;
 1 PO150A679   304
 2 IA671B041   294
 3 MM429A932   292
 4 PO150A166   290
 5 PO150A763   288
 6 IA671B106   288
 7 NS509G964   286
 8 PO150A821   284
 9 IA671B045   282
10 NO133A000   280
# … with 65 more rows</code></pre>
</div>
<h3 id="crear-o-transformar-columnas">Crear o transformar columnas</h3>
<p>Para crear nuevas columnas aplicando funciones a otras, o bien para transformar columnas se usa <code>mutate()</code>. Se pueden modificar más de una columna a la vez. Por ejemplo, suponiendo que interesa obtener el logaritmo natura de los pesos o elevar los pesos al cuadrado.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>terneros</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>log_peso <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>Peso</span><span class='op'>)</span>, peso2 <span class='op'>=</span> <span class='va'>Peso</span><span class='op'>**</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>Peso</span>, <span class='va'>log_peso</span>, <span class='va'>peso2</span><span class='op'>)</span>                        <span class='co'># para que se vea mejor el resultado </span>
</code></pre>
</div>
<pre><code># A tibble: 1,598 × 3
    Peso log_peso peso2
   &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;
 1   204     5.32 41616
 2   186     5.23 34596
 3   182     5.20 33124
 4   186     5.23 34596
 5   186     5.23 34596
 6   208     5.34 43264
 7   170     5.14 28900
 8   188     5.24 35344
 9   172     5.15 29584
10   172     5.15 29584
# … with 1,588 more rows</code></pre>
</div>
<p>Esto no cambia el set de datos <code>terneros</code> ya que no se lo asignó a ningun objeto. Para sobreescribir o actualiza el set de datos <code>terneros</code> hay que asignarlo al mismo objeto.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>terneros</span> <span class='op'>&lt;-</span> <span class='va'>terneros</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>log_peso <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>Peso</span><span class='op'>)</span>, peso2 <span class='op'>=</span> <span class='va'>Peso</span><span class='op'>**</span><span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Aclaración: Si se hubiese usado <code>select()</code> el set de datos terneros solamente contendría las columnas seleccionadas.</p>
<p>Otro ejemplo más útil: calcular los z-scores de los peso (para ello se requiere calcular el promedio y desvio) y crear una columna que indique si es un outlier y luego reportar los que son outliers.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>terneros</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>z <span class='op'>=</span> <span class='op'>(</span><span class='va'>Peso</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>Peso</span><span class='op'>)</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>Peso</span><span class='op'>)</span>, outlier <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>z</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>3</span>, <span class='st'>"si"</span>, <span class='st'>"no"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>outlier</span> <span class='op'>==</span> <span class='st'>"si"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>IDV</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 2 × 1
  IDV      
  &lt;chr&gt;    
1 PO150A679
2 IA671B041</code></pre>
</div>
<h3 id="resmuir-datos">Resmuir datos</h3>
<p>Mediante <code>summarise()</code> se pueden aplicar funciones para resumir en un solo valor los valores de las columnas. Las funciones a aplicar deben devolver un único valor, por ejemplo <code>mean()</code>. Si usamos <code>summary()</code> esto devolverá 6 valores y dará error.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>terneros</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>media <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>Peso</span><span class='op'>)</span>, sd <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>Peso</span><span class='op'>)</span>, n <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span>, suma <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>Peso</span><span class='op'>)</span>, procedencias <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/n_distinct.html'>n_distinct</a></span><span class='op'>(</span><span class='va'>Procedencia</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 1 × 5
  media    sd     n   suma procedencias
  &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt;        &lt;int&gt;
1  183.  37.0  1598 291802            7</code></pre>
</div>
<p>Nuevamente estos resultados pueden asignarse a otro objeto o bien encadenarse con otras operaciones.</p>
<p>Otro ejemplo, obtener la cantidad de terneros de cada procedencia</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>terneros</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/count.html'>count</a></span><span class='op'>(</span><span class='va'>Procedencia</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 7 × 2
  Procedencia        n
  &lt;chr&gt;          &lt;int&gt;
1 Don Alberto       69
2 La Alameda       201
3 La Estrella      118
4 La Rosita         98
5 La Segunda        43
6 Las Glicinas     494
7 Los Corralitos   575</code></pre>
</div>
<p>Otro ejemplo más, cantidad de terneros de cada procedencia separados en mayor o menor a 200 kg</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>terneros</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/count.html'>count</a></span><span class='op'>(</span><span class='va'>Procedencia</span>, <span class='va'>Peso</span> <span class='op'>&gt;</span> <span class='fl'>200</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 14 × 3
   Procedencia    `Peso &gt; 200`     n
   &lt;chr&gt;          &lt;lgl&gt;        &lt;int&gt;
 1 Don Alberto    FALSE           49
 2 Don Alberto    TRUE            20
 3 La Alameda     FALSE          136
 4 La Alameda     TRUE            65
 5 La Estrella    FALSE          112
 6 La Estrella    TRUE             6
 7 La Rosita      FALSE           89
 8 La Rosita      TRUE             9
 9 La Segunda     FALSE            5
10 La Segunda     TRUE            38
11 Las Glicinas   FALSE          428
12 Las Glicinas   TRUE            66
13 Los Corralitos FALSE          315
14 Los Corralitos TRUE           260</code></pre>
</div>
<h3 id="agrupar-último-pero-no-menos-importante">Agrupar (último pero no menos importante)</h3>
<p>El verbo <code>group_by()</code> es muy útil para aplicar operaciones en subgrupos y presentar todo junto (<em>split-apply-combine</em>). Lo que hace es indicar que en el <code>data.frame</code> hay una o más variables que conforman los grupos. Luego cada operación se aplica a esos subgrupos.</p>
<p>Ejemplo: calcular media, desvio, n y suma para cada procedencia.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>terneros</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>Procedencia</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>media <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>Peso</span><span class='op'>)</span>, sd <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>Peso</span><span class='op'>)</span>, n <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span>, suma <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>Peso</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 7 × 5
  Procedencia    media    sd     n   suma
  &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt;
1 Don Alberto     179.  26.9    69  12354
2 La Alameda      190.  39.5   201  38192
3 La Estrella     179.  14.2   118  21138
4 La Rosita       180.  17.4    98  17620
5 La Segunda      229.  24.8    43   9868
6 Las Glicinas    160.  33.7   494  79254
7 Los Corralitos  197.  35.2   575 113376</code></pre>
</div>
<h3 id="muestrear">Muestrear</h3>
<p>El verbo <code>sample_n()</code> and <code>sample_frac()</code> son útiles para tomar muestras aleatorias (con o sin reposición) de un conjunto de observaciones. También se puede hacer por subgrupo!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Una muestra de 50 novillos</span>
<span class='va'>muestra50</span> <span class='op'>&lt;-</span> <span class='va'>terneros</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/sample_n.html'>sample_n</a></span><span class='op'>(</span><span class='fl'>50</span><span class='op'>)</span>
<span class='va'>muestra50</span>
</code></pre>
</div>
<pre><code># A tibble: 50 × 10
   IDV       Procedencia    Sexo  `Fecha Ingreso`     Categoria
   &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt; &lt;dttm&gt;              &lt;chr&gt;    
 1 PO150A764 Los Corralitos Macho 2017-07-20 00:00:00 Ternero  
 2 SZ208H756 Las Glicinas   Macho 2017-07-20 00:00:00 Ternero  
 3 NO133A053 Las Glicinas   Macho 2017-07-23 00:00:00 Ternero  
 4 PO150A463 Los Corralitos Macho 2017-07-22 00:00:00 Ternero  
 5 SZ208H744 Las Glicinas   Macho 2017-07-21 00:00:00 Ternero  
 6 NS509H021 Los Corralitos Macho 2017-07-22 00:00:00 Ternero  
 7 SZ208H735 Las Glicinas   Macho 2017-07-21 00:00:00 Ternero  
 8 GT542A662 Las Glicinas   Macho 2017-07-21 00:00:00 Ternero  
 9 SZ208H865 Las Glicinas   Macho 2017-07-20 00:00:00 Ternero  
10 SZ208H818 Las Glicinas   Macho 2017-07-24 00:00:00 Ternero  
# … with 40 more rows, and 5 more variables: Fecha &lt;dttm&gt;,
#   Hora &lt;dttm&gt;, Peso &lt;dbl&gt;, log_peso &lt;dbl&gt;, peso2 &lt;dbl&gt;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Una muestra de 10 novillos de cada procedencia</span>
<span class='va'>muestra_procedencia</span> <span class='op'>&lt;-</span> <span class='va'>terneros</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>Procedencia</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/sample_n.html'>sample_n</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>
<span class='va'>muestra_procedencia</span>
</code></pre>
</div>
<pre><code># A tibble: 70 × 10
# Groups:   Procedencia [7]
   IDV       Procedencia Sexo  `Fecha Ingreso`     Categoria
   &lt;chr&gt;     &lt;chr&gt;       &lt;chr&gt; &lt;dttm&gt;              &lt;chr&gt;    
 1 GH738B351 Don Alberto Macho 2017-06-16 00:00:00 Ternero  
 2 GH738B383 Don Alberto Macho 2017-06-16 00:00:00 Ternero  
 3 GH738B326 Don Alberto Macho 2017-07-20 00:00:00 Ternero  
 4 GH738B348 Don Alberto Macho 2017-07-23 00:00:00 Ternero  
 5 GH738B372 Don Alberto Macho 2017-07-24 00:00:00 Ternero  
 6 GH738B350 Don Alberto Macho 2017-07-22 00:00:00 Ternero  
 7 GH738B347 Don Alberto Macho 2017-07-23 00:00:00 Ternero  
 8 GH738B343 Don Alberto Macho 2017-06-16 00:00:00 Ternero  
 9 GH738B381 Don Alberto Macho 2017-07-22 00:00:00 Ternero  
10 GH738B332 Don Alberto Macho 2017-07-23 00:00:00 Ternero  
# … with 60 more rows, and 5 more variables: Fecha &lt;dttm&gt;,
#   Hora &lt;dttm&gt;, Peso &lt;dbl&gt;, log_peso &lt;dbl&gt;, peso2 &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<div class="distill-site-nav distill-site-footer">
<p>Material preparado por <a href="https://github.com/Estadistica-FCA">Cátedra de Estadística FCA-UNL</a></p>
<p style="text-align: center;">
  <center>
    <img src="assets/logo_FCA_inv.png" style="height:50px;"/>
  </center>
</p>
</div>
<!--/radix_placeholder_navigation_after_body-->


</body>

</html>
